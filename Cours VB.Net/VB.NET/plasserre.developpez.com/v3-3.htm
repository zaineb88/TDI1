<html>


<!-- Mirrored from plasserre.developpez.com/v3-3.htm by HTTrack Website Copier/3.x [XR&CO'2008], Thu, 18 Dec 2008 18:22:44 GMT -->
<head>
<meta http-equiv="Content-Language" content="fr">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<META NAME="MS.LOCALE" CONTENT="fr-FR">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>Cours Visual Basic .NET les boutons : button </title>
</head>

<body background="vfond.jpg" leftmargin="90">

<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="103%" id="AutoNumber1" height="62">
  <tr>
    <td width="27%" height="62"><font face="Courier New"><b>
    <font size="5" color="#0000FF">Site</font></b><img border="0" src="ldf.GIF" width="121" height="51"><font color="#0000FF" size="5">:</font></font></td>
    <td width="53%" height="62" align="center"><b>
    <font face="Arial" size="7" color="#0000FF">&nbsp;</font><font size="7" color="#0000FF" face="Courier New">Cours VB.net</font></b></td>
    <td width="13%" height="62">
    <img border="0" src="vhom.JPG" width="118" height="114"></td>
    <td width="34%" height="62">&nbsp;</td>
  </tr>
</table>
<table border="2" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2" height="76">
  <tr>
    <td width="29%" height="76" align="center"><a href="v3-2.htm">
    <img border="0" src="vbtret.GIF" width="78" height="28"></a> <b>
    <font face="Courier New" size="6" color="#800080">3.3</font></b></td>
    <td width="47%" height="76" align="center"><b>
    <font size="6" color="#800080" face="Courier New">Les Boutons.</font></b></td>
    <td width="14%" height="76"><a href="v3-4.htm">
    <img border="0" src="vbtsuiv.GIF" width="78" height="28"></a></td>
    <td width="11%" height="76"><a href="vsommair.htm">
    <img border="0" src="vbtsomm.gif" width="78" height="28"></a></td>
  </tr>
</table>
<p class="MsoNormal" style="margin-top: 6.0pt" align="center">
<img border="0" src="voutils.JPG" width="51" height="50"></p>
<p class="MsoNormal" style="margin-top: 6.0pt"><font face="Courier New" size="2" color="#800080"><span style="font-weight: 700">Ils sont omniprésent 
dans les 
'formulaires'.</span></font></p>
<p style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">&nbsp;</p>
<p class="MsoNormal" style="margin-top: 6pt">
<span style="font-weight: 700; font-family: Courier New; font-style: italic; background-color:#C0C0C0">
<font size="4" color="#0000FF">Créer un bouton&nbsp;:</font></span></p>
<p class="MsoNormal" style="margin-top: 6pt">
<span style="font-size: 10pt; font-family: Courier New">Cliquer sur ‘Boite à 
Outils’ à gauche ,( bouton Windows Forms en VB 2003), puis bouton &quot;Button&quot;,cliquer dans 
Form1, déplacer le curseur sans lâcher le bouton, puis lâcher le bouton&nbsp;: un 
bouton apparaît.</span></p>
<p class="MsoNormal" style="margin-top: 6pt" align="center"><img border="0" src="vb2008form.JPG" width="539" height="287"></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">&nbsp;</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
&nbsp;</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<i><b><font size="4" face="Courier New" color="#0000FF">
<span style="background-color: #C0C0C0">Modifier ses propriétés:</span></font></b></i></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
&nbsp;</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<font face="Courier New" size="2">On peut modifier les propriétés dans la 
fenêtre des propriétés en bas à droite:</font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt" align="center">
<img border="0" src="v2005p6.JPG" width="191" height="449"></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
&nbsp;</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<font face="Courier New" size="2">On peut aussi modifier les propriétés par du 
code.</font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
&nbsp;</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
&nbsp;</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<span style="font-size: 10.0pt; font-family: Courier New; color: #0000FF; font-weight: 700">
Name</span><span style="font-size: 10.0pt; font-family: Courier New; color: windowtext; font-weight: normal"> 
est utilisé pour lui donner un nom explicite (BoutonOk BoutonCancel)</span></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
&nbsp;</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<span style="font-family: Courier New; "><b><font size="2" color="#0000FF">
FlatStyle</font></b></span><span style="font-family: Courier New; color: windowtext"><font size="2"> </font></span>
<span style="font-family: Courier New; color: windowtext; font-weight: normal">
<font size="2">donne un aspect au bouton (Flat, standard, System, pop Up)</font></span></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
&nbsp;</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<font size="2"><span style="font-family: Courier New; color: windowtext; font-weight: normal">E</span></font><span style="font-family: Courier New; color: windowtext; font-weight: normal"><font size="2">n VB 2003</font></span></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<img border="0" src="vButons.gif" width="315" height="34"></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
&nbsp;</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<font face="Courier New" size="2">En vb2005 et 2008:</font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<img border="0" src="vbuttons2.JPG" width="396" height="46"></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
&nbsp;</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt"><font face="Courier New" size="2">Standard
et System utilisent le thème d'affichage de Windows&nbsp; que vous avez
choisi&nbsp; dans le panneau de configuration. (Thème Windows XP, personnel..)</font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt"><font face="Courier New" size="2">Quand
on utilise Flat on peut dérouler </font><font face="Courier New" size="2"> FlatStyle
et choisir dans FlatStyle l'épaisseur du bord et sa
couleur (3 et rouge dans notre premier bouton VB 2008).</font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt"><font face="Courier New" size="2">Enfin
on peut choisir la position du texte avec <font color="#0000FF">TextAlign</font>.
Il a la valeur TopLeft dans le dernier bouton.</font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
&nbsp;</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<font size="2">
<span style="font-family: Courier New; font-weight: 700">
<font color="#0000FF">Text</font></span><span style="font-family: Courier New; color: windowtext; font-weight: 700">

</span>
</font>
<span style="font-family: Courier New; color: windowtext; font-weight: normal">
<font size="2">contient le texte a afficher sur le bouton. </span>
<span style="font-family: Courier New; color: windowtext; font-weight: 700">
ForeColor</span><span style="font-family: Courier New; color: windowtext; font-weight: normal">
correspond à la couleur de ce texte (</span><span style="font-family: Courier New; color: windowtext; font-weight: 700">BackColor</span><span style="font-family: Courier New; color: windowtext; font-weight: normal">
étant la couleur du fond)</span></font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<font size="2"><span style="font-family: Courier New">Exemple:</span></font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<font color="#0000FF" face="Courier New" size="2">button1.Text=&quot;Ok&quot; </font>
<font face="Courier New" size="2">affiche 'Ok' dans le bouton.</font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
&nbsp;</p>
<blockquote>
<p style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<b><font face="Courier New" size="2">En VB 2003 et 2005:</font></b></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<span style="font-family: Courier New; color: windowtext; font-weight: normal">
<font size="2">Si on y inclut un «&nbsp;&amp;&nbsp;» la lettre qui suit sera soulignée et servira 
de raccourci clavier.&nbsp; </font></span></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<font size="2" color="#0000FF"><span style="font-family: Courier New">
Button.Text= &quot;</span></font><font size="2"><font color="#0000FF"><span style="font-family: Courier New; font-weight: normal">&amp;Ok&quot;</span></font><span style="font-family: Courier New; color: windowtext; font-weight: normal">&nbsp;
affiche sur le bouton&nbsp; </span><u>
<span style="font-family: Courier New; color: windowtext">O</span></u></font><span style="font-family: Courier New; color: windowtext; font-weight: normal"><font size="2">k&nbsp;&nbsp; 
et crée le raccourci clavier 'Ctrl O' qui est l'équivalent d'un click sur le bouton. </font></span></p>
  <p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt"><font size="2"><span style="font-family: Courier New; color: windowtext"><b>En
  VB 2008</b></span><span style="font-family: Courier New; color: windowtext; font-weight: normal">,
  il faut que la propriété </span><span style="font-family: Courier New; font-weight: normal"><font color="#0000FF">UseMnemonic</font></span><span style="font-family: Courier New; color: windowtext; font-weight: normal">
  du bouton ai la valeur </span><span style="font-family: Courier New; font-weight: normal"><font color="#0000FF">True</font></span><span style="font-family: Courier New; color: windowtext; font-weight: normal">
  pour pouvoir utiliser le raccourci clavier et le raccourci, pour
  &quot;&amp;Ok&quot;, est dans ce cas 'O' ou 'Alt O'.</span></font></p>
</blockquote>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
&nbsp;</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<font size="2"><span style="font-family: Courier New"><font color="#0000FF"><b>TextAlign</b></font> permet de 
positionner le texte dans le bouton.</span></font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
&nbsp;</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<font size="2">
<span style="font-family: Courier New; "><b>
<font color="#0000FF">Image</font></b></span><span style="font-family: Courier New; color: windowtext"> </span>
</font>
<font size="2">
<span style="font-family: Courier New; color: windowtext; font-weight: normal">
contient le nom de l’image à afficher sur le bouton (si on veut 
afficher une image, on le fait en mode Design; noter que quand on distribue 
l'application, il n'y a pas besoin de fournir le fichier contenant l'image avec 
l'application ). (</span><span style="font-family: Courier New; color: windowtext; font-weight: 700">ImageAlign</span><span style="font-family: Courier New; color: windowtext; font-weight: normal"> 
permet de positionner l’image sur le bouton, </span><span style="font-family: Courier New; color: windowtext; font-weight: 700">TextAlign</span><span style="font-family: Courier New; color: windowtext; font-weight: normal"> 
 fait de même pour le texte.)</span></font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
&nbsp;</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt" align="center">
<img border="0" src="vbuton.JPG" width="58" height="34"></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
&nbsp;</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<font size="2">
<span style="font-family: Courier New; color: windowtext; font-weight: normal">
On peut aussi puiser une image dans une </span>
<span style="font-family: Courier New; color: windowtext; font-weight: 700">
ImageList</span><span style="font-family: Courier New; color: windowtext; font-weight: normal"> 
grâce à la propriété </span>
<span style="font-family: Courier New; color: windowtext; font-weight: 700">
ImageList</span><span style="font-family: Courier New; color: windowtext; font-weight: normal"> 
et </span>
<span style="font-family: Courier New; color: windowtext; font-weight: 700">
ImageIndex</span><span style="font-family: Courier New; color: windowtext; font-weight: normal">, 
on peut ainsi changer d’image.</span></font></p>
<p style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt"><font face="Courier New" size="2">On
clique sur 'Image' dans la fenêtre de propriété, puis sur le petit bouton à
droite avec les '...' et on choisi l'image dans les ressources.&nbsp;</font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<font size="2"><span style="font-family: Courier New">Si le Flatstyle a la valeur
'System' l'image n'apparaît pas.</span></font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
&nbsp;</p>
<p style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt"><font face="Courier New" size="2"><b><font color="#0000FF">TextImageRelation</font></b>
permet de définir les relations entre le texte et l'image: avant, après,
dessus (Overlay).</font></p>
<p style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">&nbsp;</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<font face="Courier New">En VB 2008, l'image est chargée dans les
ressources.&nbsp;</font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<font size="2"><span style="font-family: Courier New">Les formats acceptés
sont: bmp, gif, jpg, wpf, png.</span></font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<font size="2"><span style="font-family: Courier New">La propriété <b>
BackGroundImage</b> permet aussi de mettre une image de fond.</span></font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
&nbsp;</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<font size="2" color="#0000FF"><b><span style="font-family: Courier New">Font</span></b></font><font size="2"><span style="font-family: Courier New; color: windowtext"> </span>
<span style="font-family: Courier New; color: windowtext; font-weight: normal">
contient la police de caractère, sa taille, son enrichissement (gras, 
italique..)</span></font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<font size="2" face="Courier New">Truc: quand vous travaillez sur de très petits 
boutons, changer la propriété <font color="#0000FF">Font</font> et choisir une 
petite taille de caractère (8 par exemple)</font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
&nbsp;</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<font face="Courier New" size="2">Exemple:</font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<font SIZE="2" face="Courier New"><img border="0" src="vbtok2008.JPG" width="72" height="38">&nbsp;
</font>
</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<font face="Courier New" size="2" color="#0000FF">Text= &quot;Ok&quot;</font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt"><font face="Courier New" size="2" color="#0000FF">Image=
MonProgramme.My.Resources.Resources.BtOk</font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<font SIZE="2" face="Courier New" color="#0000FF">TextImageRelation=TextBeforeImage
</font>
</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt"><font size="2" face="Courier New" color="#0000FF">ImageAlign=
MiddleRigth</font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt"><font size="2" face="Courier New" color="#0000FF">TextAlign=
MiddleLeft</font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">&nbsp;</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">&nbsp;</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
&nbsp;</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<font size="4" color="#0000FF">
<span style="font-family: Courier New; font-weight: 700; font-style: italic; background-color:#C0C0C0">
Utiliser les évènements:</span></font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<span style="font-family: Courier New; color: windowtext; font-weight: normal">
<font size="2">L’évènement principalement utilisé est</font></span><font size="2"><span style="font-family: Courier New; color: windowtext">
<b>Click()</b>&nbsp;: quand l’utilisateur clique sur le bouton la procédure </span></font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
&nbsp;</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<font color="#0000FF" size="2"><span style="font-family: Courier New; ">Private 
Sub
Button_Click(..)</span></font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
&nbsp;</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<font color="#0000FF" face="Courier New" size="2">End Sub</font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
&nbsp;</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<font size="2"><span style="font-family: Courier New; color: windowtext">est
exécutée.</span></font></p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<font size="2"><span style="font-family: Courier New">Cette procédure contient 
le code qui doit être exécuté lorsque l'utilisateur clique sur le bouton.</span></font></p>
<p class="MsoNormal" style="margin-top: 6pt"><font face="Courier New" size="2">
Le bouton peut être sélectionné grâce à un clic de souris, à la touche ENTRÉE ou 
à la BARRE d'espacement si le bouton a le focus.<br>
&nbsp;</font></p>
<p class="MsoNormal" style="margin-top: 6pt">&nbsp;</p>
<p class="MsoNormal" style="margin-top: 6pt"><i><b>
<font face="Courier New" size="4" color="#0000FF">
<span style="background-color: #C0C0C0">Créer un bouton Ok ou Cancel:</span></font></b></i></p>
<p class="MsoNormal" style="margin-top: 6pt"><font face="Courier New" size="2">
Parfois il faut permettre aux utilisateurs de sélectionner un bouton en appuyant 
sur la touche ENTRÉE&nbsp; même si le bouton n'a pas le focus.</font></p>
<p class="MsoNormal" style="margin-top: 6pt"><font face="Courier New" size="2">
Exemple: Il y a sur la fenêtre un bouton &quot;Ok&quot; qui doit être enfoncé quand 
l'utilisateur tape 'Enter' au clavier, c'est le bouton qui 'valide' le 
questionnaire ( et qui le ferme souvent).</font></p>
<p class="MsoNormal" style="margin-top: 6pt"><font face="Courier New" size="2">
Comment faire?</font></p>
<p class="MsoNormal" style="margin-top: 6pt"><font face="Courier New" size="2">
Définissez la propriété <font color="#0000FF">AcceptButton </font>&nbsp;de la 
Form&nbsp; en lui donnant le nom du bouton.</font></p>
<p class="MsoNormal" style="margin-top: 6pt"><font face="Courier New" size="2">
Cela permet au formulaire d'avoir le comportement d'une boîte de dialogue.<br>
&nbsp;</font></p>
<p class="MsoNormal" style="margin-top: 6pt"><font face="Courier New" size="2">La propriété
<font color="#0000FF">CancelButton </font>&nbsp;de la 
Form&nbsp; permet de la même manière&nbsp; de créer un bouton 'Annuler'( qui
répond à la touche 'Echap'(ESC).</font></p>
<p class="MsoNormal" style="margin-top: 6pt">&nbsp;</p>
<p class="MsoNormal" style="margin-top: 6pt"><i><b>
<font face="Courier New" size="4" color="#0000FF">
<span style="background-color: #C0C0C0">Couleur transparent dans les images des 
boutons:</span></font></b></i></p>
<font SIZE="2">
<p><font face="Courier New">On a vu qu'on pouvait mettre une image dans un bouton , il faut pour cela 
donner à la propriété <font color="#0000FF">Image </font>le nom du fichier contenant l'image, 
ceci en mode Design. En VB 2008, elle est chargée dans les ressources.&nbsp;</font></p>
</font>
<font SIZE="2" COLOR="#0000ff">
</font>
<font SIZE="2">
<p><font face="Courier New">Mais l'image est souvent dans un carré et on voudrait ne pas voir le fond 
(rendre la couleur du tour de l'image <b>transparente</b>)</font></p>
<p><font face="Courier New">Dans Visual Basic 6.0 on chargeait </font><font face="Courier New"> l'image <img border="0" src="viconote.gif" width="34" height="30"></font><font face="Courier New">
un fichier .bmp. La propriété MaskColor&nbsp; était utilisée pour 
définir une couleur qui devait devenir transparente (ici le jaune), permettant ainsi 
l'affichage d'un bouton ayant l'aspect suivant.</font></p>
<p align="center"><font face="Courier New"><img border="0" src="vbuton.JPG" width="58" height="34"></font></p>
<p align="left"><font face="Courier New">Mais dans Visual Basic .NET, il n'existe pas d'équivalent direct de la propriété MaskColor!!&nbsp;</font></p>
<p align="left"><font face="Courier New">On peut résoudre le problème:</font></p>
<p><font face="Courier New">1- <b>On peut créer une image Gif avec un fond
Transparent (créer avec le logiciel gratuit 'PhotoStyle'), 
Vb 2005 ou 2008 n'affichent pas le transparent autour.</b></font></p>
<p align="center"><img border="0" src="vbtok2008.JPG" width="72" height="38"></p>
<p><font face="Courier New">2- <b>Si on a une image avec un fond jaune ou d'une 
autre couleur, on peut ruser et définir la transparence:</b></font></p>
<p><font face="Courier New">Dans le &quot; Code généré par le Concepteur Windows Form 
&quot; après la définition du bouton&nbsp; ou dans <font color="#0000FF">Form_Load</font> 
ajouter:</font></p>
</font>
<font SIZE="2" COLOR="#0000ff">
<p style="margin-top: 0; margin-bottom: 0"><font face="Courier New">Dim</font></font><font SIZE="2" face="Courier New" color="#0000FF"> g As New</font><font SIZE="2"><font face="Courier New" color="#0000FF"> 
System.Drawing.Bitmap(Button1.Image)</font></p>
<p style="margin-top: 0; margin-bottom: 0">
<font face="Courier New" color="#0000FF">g.MakeTransparent(System.Drawing.Color.Yellow)</font></p>
<p style="margin-top: 0; margin-bottom: 0">
<font face="Courier New" color="#0000FF">Button1.Image = g</font></p>
</font>
<p class="MsoNormal" style="margin-top: 6pt"><font face="Courier New" size="2">
On récupère dans un Bitmap l'image du bouton, on indique que le jaune doit être 
transparent, on remet le BitMap dans l'image.</font></p>
<p class="MsoNormal" style="margin-top: 6pt"><font face="Courier New" size="2">
Bien sur il y a intérêt à choisir une couleur (toujours la même) qui tranche 
pour les fonds de dessin et ne pas l'utiliser dans le dessin lui même.</font></p>
<p class="MsoNormal" style="margin-top: 6pt">
&nbsp;</p>
<p class="MsoNormal" style="margin-top: 6pt">
&nbsp;</p>
<p class="MsoNormal" style="margin-top: 6pt"><i><b>
<font face="Courier New" size="4" color="#0000FF">
<span style="background-color: #C0C0C0">Utilisation avancée: </span></font></b></i>
<span style="background-color: #C0C0C0"><b><i>
<font face="Courier New" size="4" color="#0000FF">Créer de magnifique bouton en 
VB2005</font></i></b></span><i><b><font face="Courier New" size="4" color="#0000FF"><span style="background-color: #C0C0C0">:</span></font></b></i></p>
<font SIZE="2">
<p><font face="Courier New">On peut créer des boutons avec ses propres images:</font></p>
<p align="center"><font face="Courier New">Exemple donné par Microsoft:&nbsp;
<img border="0" src="vbeaubuton.JPG" width="156" height="35"></font></p>
<p align="left"><font face="Courier New">Pour faire cela il faut créer le 
dessin, le mettre en fond et paramétrer correctement le bouton.</font></p>
<p align="left"><b><font face="Courier New">1-Mettre le dessin dans les 
ressources:</font></b></p>
<p align="left"><font face="Courier New">Aller dans les ressources (ensemble 
d'éléments,: images, textes, sons.. qui seront incorporés dans le programme.)</font></p>
<p align="left"><font face="Courier New">(Pour cela double cliquez sur MyProjet 
dans l'explorateur de solution ou menu 'Projet'=&gt;'Propriétés de..', Onglet 
'Ressources')</font></p>
<p align="left"><font face="Courier New">Dérouler la liste à gauche pour y 
mettre 'Images' puis cliquer sur 'ajouter une ressource'; on vous demande le nom 
de la ressource (tapez par exemple 'button_blue'), vous vous trouver dans Paint, 
dessinez (ou collez) l'image de votre bouton. Puis menu 
'Fichier'=&gt;'Enregistrer': le dessin apparaît dans les ressources. Fermez Paint.</font></p>
<p align="left"><img border="0" src="vbeaubuton1.JPG" width="317" height="202"></p>
<p align="left"><b><font face="Courier New" size="2">2-Mettre ce dessin comme fond du bouton:</font></b></p>
</font>
<p style="margin-top: 0; margin-bottom: 0"><font SIZE="2">
<font face="Courier New" color="#0000FF" size="2">MyButton.BackGroundImage= 
MonProgramme.My.Ressources.Ressources.button_Blue</font></font></p>
<p style="margin-top: 0; margin-bottom: 0"><font face="Courier New" size="2">(ou 
modifier cette propriété<font face="Courier New" size="2" color="#0000FF"> 
BackGroundImage </font>dans la fenêtre de 
propriétés à droite)</font></p>
<p style="margin-top: 0; margin-bottom: 0">&nbsp;</p>
<p style="margin-top: 0; margin-bottom: 0">
<font SIZE="2" face="Courier New">
<b>2-Modifier les propriétés du bouton dans la fenêtre de propriétés:</b></font></p>
<p style="margin-top: 0; margin-bottom: 0">&nbsp;</p>
<p style="margin-top: 0; margin-bottom: 0"><font size="2" face="Courier New">En effet l'image de la 
ressources n'a pas la même taille que le bouton, de plus le dessin du bouton 
standard apparaît!!</font></p>
<p style="margin-top: 0; margin-bottom: 0">
<font face="Courier New" size="2">
<font color="#0000FF">MyButton.BackGroundImageLayout= 
Stretch&nbsp; </font>'met le dessin à la 
taille du bouton.</font></p>
<p style="margin-top: 0; margin-bottom: 0">
<font face="Courier New" size="2">
<font color="#0000FF">MyButton.FlatStyle= Flat&nbsp; </font>'fait disparaître des éléments du 
bouton standard.</font></p>
<p style="margin-top: 0; margin-bottom: 0">
<font face="Courier New" size="2">
<font color="#0000FF">MyButton.BackColor= 
Transparent&nbsp; </font>'Efface le fond du 
bouton standard.</font></p>
<p style="margin-top: 0; margin-bottom: 0">
<font face="Courier New" size="2">
<font color="#0000FF">MyButton.Text= &quot;Importer 
Image'&nbsp; </font>'met le texte.</font></p>
<p style="margin-top: 0; margin-bottom: 0">&nbsp;</p>
<p style="margin-top: 0; margin-bottom: 0"><font size="2" face="Courier New">Super, c'est beau!!</font></p>
<p style="margin-top: 0; margin-bottom: 0">&nbsp;</p>
<p style="margin-top: 0; margin-bottom: 0">&nbsp;</p>
<p style="margin-top: 0; margin-bottom: 0"><font size="2" face="Courier New">On peut aussi en VB 
2003 ou VB2005 <b>personnaliser ses boutons</b>.</font></p>
<p style="margin-top: 0; margin-bottom: 0"><font face="Courier New" size="2">Un 
exemple: </font></p>
<p style="margin-top: 0; margin-bottom: 0">
<img border="0" src="v5-3.h3.GIF" width="301" height="104"></p>
<p style="margin-top: 0; margin-bottom: 0"><font size="2" face="Courier New">Voir<b>
<a href="v5-3.htm">5-3.htm</a> </b>c'est un peu complexe!!</font></p>
<p style="margin-top: 0; margin-bottom: 0">&nbsp;</p>
<p style="margin-top: 0; margin-bottom: 0">&nbsp;</p>
<p style="margin-top: 0; margin-bottom: 0">&nbsp;</p>
<p class="MsoNormal" style="margin-top: 6pt"><i><b>
<font face="Courier New" size="4" color="#0000FF">
<span style="background-color: #C0C0C0">Utilisation avancée: Création d'un bouton par code:</span></font></b></i></p>
<p class="MsoNormal" style="margin-top: 6pt"><font face="Courier New" size="2">
L'exemple suivant crée un Button nommé Button1&nbsp; sur lequel on voit &quot;Ok&quot;, on 
modifie certaines de ses propriétés et on l'ajoute à Form.<br>
&nbsp;<br>
<font color="#0000FF">Private Sub InitializeMonButton()<br>
Dim button1 As New Button1()<br>
button1.Text=&quot;Ok&quot;<br>
</font><font color="#008000">' Ajouter le bouton à la Form</font><font color="#0000FF"><br>
Controls.Add(button1)<br>
End Sub </font></font></p>
<p class="MsoNormal" style="margin-top: 6pt"><font face="Courier New" size="2">
Il faut par code créer aussi les évènements liés à ce bouton: dans ce cas il 
faut déclarer le bouton&nbsp; 
plutôt avec la syntaxe contenant WithEvents et en haut du module.</font></p>
<p><font face="Courier New" color="#0000ff" size="2">Private <b>WithEvents</b> 
Button1 As New Button</font></p>
<p><font face="Courier New" size="2">(dans ce cas on ne remet pas la ligne Dim 
button1 dans la Sub InitializeMonButton)</font></p>
<p><font face="Courier New" size="2">Puis écrire la sub évènement.</font></p>
<p><font face="Courier New" color="#0000ff" size="2">Sub OnClique ( sender As 
Objet, EvArg As EventArgs) <b>Handles </b>Button1</font></p>
<p><font face="Courier New" color="#0000ff" size="2">End Sub&nbsp; </font></p>
<p><font face="Courier New" size="2">Ainsi VB sait que pour un évènement sur le 
Button1 , il faut déclencher la Sub OnClique.</font></p>
<p><font face="Courier New" size="2">(On reviendra sur cela)</font></p>
<p class="MsoNormal" style="margin-top: 6pt">&nbsp;</p>
<p class="MsoNormal" style="margin-top: 6pt">
&nbsp;</p>
<p class="titre3" style="margin-left: 0cm; margin-right: 0cm; margin-top: 6.0pt; margin-bottom: .0001pt">
<span style="font-family: Courier New; color: windowtext">&nbsp;</span></p>
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber3" height="51">
  <tr>
    <td width="25%" height="51"><a href="v3-2.htm">
    <img border="0" src="vbtret.GIF" width="78" height="28"></a></td>
    <td width="25%" height="51"><a href="vindex.htm">
    <img border="0" src="vbtind.GIF" width="78" height="28"></a></td>
    <td width="25%" height="51"><a href="vsommair.htm">
    <img border="0" src="vbtsomm.gif" width="78" height="28"></a></td>
    <td width="25%" height="51"><a href="v3-4.htm">
    <img border="0" src="vbtsuiv.GIF" width="78" height="28"></a></td>
  </tr>
</table>

</body>


<!-- Mirrored from plasserre.developpez.com/v3-3.htm by HTTrack Website Copier/3.x [XR&CO'2008], Thu, 18 Dec 2008 18:22:48 GMT -->
</html>