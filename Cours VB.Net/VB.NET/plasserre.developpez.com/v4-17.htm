<html>


<!-- Mirrored from plasserre.developpez.com/v4-17.htm by HTTrack Website Copier/3.x [XR&CO'2008], Thu, 18 Dec 2008 18:24:50 GMT -->
<head>
<meta http-equiv="Content-Language" content="fr">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta NAME="MS.LOCALE" CONTENT="fr-FR">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>Cours Visual Basic .Net presse papier clipboard </title>
<style>
<!--
h6
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	font-size:11.0pt;
	font-family:"Times New Roman";
	font-weight:bold}
h4
	{margin-right:0cm;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"Times New Roman";
	font-weight:bold}
-->
</style>
</head>

<body background="vfond.jpg" leftmargin="90">

<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="103%" id="AutoNumber1" height="62">
  <tr>
    <td width="27%" height="62"><font face="Courier New"><b>
    <font size="2" color="#0000FF">Site</font></b><font size="2"><img border="0" src="ldf.GIF" width="121" height="51"></font><font color="#0000FF" size="2">:</font></font></td>
    <td width="56%" height="62" align="center"><b>
    <font face="Courier New" size="6" color="#0000FF">&nbsp;</font><font face="Courier New" size="7" color="#0000FF">Cours 
    VB.net</font></b></td>
    <td width="10%" height="62">
    <img border="0" src="vhom.JPG" width="118" height="114"></td>
    <td width="34%" height="62">&nbsp;</td>
  </tr>
</table>
<table border="2" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2" height="79">
  <tr>
    <td width="29%" height="79" align="center">
    <font face="Courier New" size="2"><a href="v4-16.htm">
    <img border="0" src="vbtret.GIF" width="78" height="28"></a> </font><b>
    <font face="Courier New" size="6" color="#800080">4.17</font></b></td>
    <td width="52%" height="79" align="center"><b>
    <font face="Courier New" size="6" color="#800080">Le presse papier.</font></b></td>
    <td width="9%" height="79"><font face="Courier New" size="2">
    <a href="v4-18.htm">
    <img border="0" src="vbtsuiv.GIF" width="78" height="28"></a></font></td>
    <td width="11%" height="79"><p><font face="Courier New" size="2">
    <a href="vsommair.htm">
    <img border="0" src="vbtsomm.gif" width="78" height="28"></a></font></p>
    </td>
  </tr>
</table>
<p align="center"><img border="0" src="vwindow.JPG" width="99" height="79"></p>
<p><b><font face="Courier New" size="2" color="#800080">On a tous coupé un bout 
de texte pour le coller à un autre endroit.</font></b></p>
<p><b><font face="Courier New" size="2" color="#800080">Pour cela on a utilisé 
le presse papier ou 'Clipboard' de Windows.</font></b></p>
<p><b><font size="2" face="Courier New" color="#800080">Comment faire cela par 
code?</font></b></p>
<p><b><font face="Courier New" size="2" color="#800080">Voyons cela en VB 2003 
et VB 2005.</font></b></p>
<p><span style="font-weight: 700; background-color: #C0C0C0">
<font face="Courier New" size="5" color="#0000FF">En VB 2003 (Framework 1)</font></span></p>
<p><font face="Courier New" size="2" color="#0000FF">
<span style="font-weight: 700; background-color: #C0C0C0">Mettre dans le presse 
papier:</span></font></p>
<p><font face="Courier New" size="2" color="#0000FF">Clipboard.SetDataObject(Texte)</font></p>
<p><font face="Courier New" size="2">il y a une surcharge:</font></p>
<p><font face="Courier New" size="2" color="#0000FF">Clipboard.SetDataObject(Texte, 
True)</font></p>
<p><font face="Courier New" size="2">Le second paramètre spécifie si les données 
doivent rester dans le Presse-papiers lorsque l'utilisateur quitte 
l'application.</font></p>
<p><font face="Courier New" size="2" color="#0000FF">
<span style="font-weight: 700; background-color: #C0C0C0">Récupérer du presse 
papier:</span></font></p>
<p><font face="Courier New" size="2" color="#0000FF">Dim iData As IDataObject</font></p>
<p><font face="Courier New" size="2"><font color="#0000FF">iData = 
Clipboard.GetDataObject()</font><br>
&nbsp;</font></p>
<p><font face="Courier New" size="2">Pour la récupération, il faut s'occuper du 
format des données: si on récupère un BipMap et qu'on le colle dans un textbox, 
il y a problème!! On récupère donc un objet qui contient les données mais aussi 
des indications sur le format des données ;on peut tester ce format avant de 
'coller'.</font></p>
<p><font face="Courier New" size="2">On récupère un objet de type
<font color="#0000FF">IDataObject</font> qui contient</font></p>
<p><font face="Courier New" size="2">&nbsp;&nbsp;&nbsp; La méthode
<font color="#0000FF">GetFormats</font> permettant de connaître <b>tous les 
formats</b> contenus dans IDataObject</font></p>
<p><font face="Courier New" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#0000FF">Dim myFormatsArray As String() = iData.GetFormats(False)</font></font></p>
<p><font face="Courier New" size="2">&nbsp;&nbsp;&nbsp; La méthode
<font color="#0000FF">GetDataPresents</font> permettant de savoir <b>si un 
format est présent</b>:</font></p>
<p><font face="Courier New" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#0000FF">If iData.GetDataPresent(DataFormats.Text) Then&nbsp;
</font>&nbsp;&nbsp; </font></p>
<p><font face="Courier New" size="2">&nbsp;&nbsp;&nbsp; La méthode
<font color="#0000FF">GetData</font> permettant de <b>récupérer les données</b> 
(paramètre: le format)</font></p>
<p><font face="Courier New" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font color="#0000FF">textBox2.Text = CType(iData.GetData(DataFormats.Text), 
String)</font></font></p>
<p>&nbsp;</p>
<p><font face="Courier New" size="2">Les différents formats:</font></p>
<p><font face="Courier New" size="2" color="#0000FF">DataFormats.Text</font></p>
<p><font face="Courier New" size="2" color="#0000FF">DataFormats.Rtf</font></p>
<p><font face="Courier New" size="2" color="#0000FF">DataFormats.Html</font></p>
<p><font face="Courier New" size="2" color="#0000FF">
DataFormats.CommaSeparatedValue</font></p>
<p><font face="Courier New" size="2" color="#0000FF">DataFormats.Dif</font></p>
<p>&nbsp;</p>
<p><font face="Courier New" size="2" color="#0000FF">DataFormats.BitMap</font></p>
<p><font face="Courier New" size="2" color="#0000FF">DataFormats.Dib</font></p>
<p><font face="Courier New" size="2" color="#0000FF">DataFormats.WaveAudio</font></p>
<p><font face="Courier New" size="2" color="#0000FF">...</font></p>
<p><font face="Courier New" size="2" color="#0000FF">
<span style="font-weight: 700; background-color: #C0C0C0">Exemple:</span></font></p>
<p><b><font face="Courier New" size="2">Mettre le texte sélectionné de TextBox1 
dans le presse papier:</font></b></p>
<p><font face="Courier New" size="2">Un Button1 nommé &quot;Copier&quot; contient le code:</font></p>
<p><font face="Courier New" size="2"><font color="#0000FF">If 
textBox1.SelectedText &lt;&gt; &quot;&quot; Then<br>
&nbsp;&nbsp;&nbsp; Clipboard.SetDataObject(textBox1.SelectedText)<br>
End if</font><br>
&nbsp;</font></p>
<p><font face="Courier New" size="2">Remarque: si je voulais un button1 &quot;Couper&quot; 
il aurait fallu ajouter </font>
<font color="#0000FF" face="Courier New" size="2">textBox1.SelectedText=&quot;&quot;</font></p>
<p><b><font face="Courier New" size="2">Récupérer le texte du presse papier et 
le mettre dans TextBox2</font></b></p>
<p><font face="Courier New" size="2">Un Button2 nommé &quot;Coller&quot; contient le code:</font></p>
<p><font face="Courier New" size="2"><font color="#0000FF">Dim iData As 
IDataObject = Clipboard.GetDataObject()<br>
<br>
</font><font color="#008000">' Détermine si c'est du texte.</font><font color="#0000FF"><br>
If iData.GetDataPresent(DataFormats.Text) Then<br>
</font><font color="#008000">' récupére le texte par GetData puis le cast en 
String</font><font color="#0000FF"><br>
textBox2.Text = CType(iData.GetData(DataFormats.Text), String)<br>
Else<br>
'</font><font color="#008000"> C'est pas du texte.</font><font color="#0000FF"><br>
textBox2.Text = &quot;Pas possible de récupérer.&quot;<br>
End If</font><b><br>
&nbsp;</b></font></p>
<p>&nbsp;</p>
<p><span style="font-weight: 700; background-color: #C0C0C0">
<font face="Courier New" size="2" color="#0000FF">Alternative:</font></span></p>
<p><font face="Courier New" size="2">Au lieu d'utiliser l'objet Clipboard, on 
peut utiliser une méthode plus simple:</font></p>
<p><font face="Courier New" size="2">Le formulaire étant actif et la textbox 
ayant le Focus envoyez CTRL C avec <font color="#0000FF">SendKeys.Send</font> 
pour couper, CTRL V pour coller: c'est Windows qui s'occupe de tout!!</font></p>
    <p align="justify">&nbsp;</p>
    <p align="justify"><font color="#0000FF" face="Courier New" size="5">
    <span style="font-weight: 700; background-color: #C0C0C0">
    My.Computer.Clipboard en VB
    <img border="0" src="v2005.JPG" width="52" height="21"></span></font></p>
    <p align="justify"><font face="Courier New" size="2"><strong>My.Computer.Clipboard :</strong> 
    permet de récupérer des informations sur le contenu du presse-papier, de 
    récupérer et de définir son contenu avec une certaine simplification.</font></p>
    <font SIZE="2" face="Courier New">
<p>On peut mettre du texte dans le presse-papier:</font></p>
<p><font face="Courier New"><font SIZE="2" COLOR="#0000ff">My</font><font SIZE="2" color="#0000FF">.Computer.Clipboard.SetText(TextBox3.Text)</font></font></p>
<p><font face="Courier New" size="2">On peut même indiquer le format du texte (rtf, 
html,&nbsp; text, unicode..):</font></p>
<p><font SIZE="2" COLOR="#0000ff" face="Courier New">My</font><font SIZE="2" color="#0000FF"><font face="Courier New">.Computer.Clipboard.SetText(TextBox3.Text, 
TextDataFormat.Rtf)</font></p>
</font>
    <p align="justify"><font face="Courier New" size="2">Il existe aussi
    <font color="#0000FF">SetImage</font>, <font color="#0000FF">SetAudio</font>...</font></p>
    <p align="justify"><font face="Courier New" size="2">On peut vérifier si le 
    Presse-papier contient une image(<font color="#0000FF">ContainsImage</font>), 
    du texte( <font color="#0000FF">ContainsText</font>), du son (<font color="#0000FF">ContainsAudio</font>).. 
    et récupérer cette image (<font color="#0000FF">GetImage</font> ) ou ce 
    texte (<font color="#0000FF">GetText</font>).</font></p>
    <p align="justify"><font color="#0000FF" face="Courier New" size="2">If 
    My.Computer.Clipboard.ContainsImage Then<br>
    &nbsp;&nbsp;&nbsp;&nbsp;PictureBox1.Image = My.Computer.Clipboard.GetImage<br>
    ElseIf My.Computer.Clipboard.ContainsText Then<br>
    &nbsp;&nbsp;&nbsp;&nbsp;TextBox1.Text = My.Computer.Clipboard.GetText<br>
    End If</font></p>
    <p align="justify">&nbsp;</p>
<p style="margin-top: 0; margin-bottom: 0">
<b><font face="Courier New" size="2">Dans VB
<img border="0" src="v2005.JPG" width="52" height="21"> (le Framework 2) pour 
copier coller dans un textbox , c'est encore plus facile:</font></b></p>
<p style="margin-top: 0; margin-bottom: 0">
<font face="Courier New" size="2">La propriété <font color="#0033FF">
ShortCutsEnabled = True</font> permet à l'utilisateur d'ouvrir un menu 
contextuel avec le click droit; ce menu permet les annuler, couper, copier, 
coller, supprimer, Sélectionner tout; ce qui peut aussi être fait avec les 
raccourcis clavier Shift/Inser Ctrl/Inser..</font></p>
<p style="margin-top: 0; margin-bottom: 0">
&nbsp;</p>
<p style="margin-top: 0; margin-bottom: 0">
<img border="0" src="vtextb2005.JPG" width="239" height="150"></p>
    <p align="justify">&nbsp;</p>
<p>&nbsp;</p>
<dl>
<dd>
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber3" height="51">
  <tr>
    <td width="25%" height="51"><font face="Courier New" size="2">
    <a href="v4-16.htm"><img border="0" src="vbtret.GIF" width="78" height="28"></a></font></td>
    <td width="25%" height="51"><a href="vindex.htm">
    <img src="vbtind.GIF" border="0" width="78" height="28"></a></td>
    <td width="25%" height="51"><font face="Courier New" size="2">
    <a href="vsommair.htm">
    <img border="0" src="vbtsomm.gif" width="78" height="28"></a></font></td>
    <td width="25%" height="51"><font face="Courier New" size="2">
    <a href="v4-18.htm">
    <img border="0" src="vbtsuiv.GIF" width="78" height="28"></a></font></td>
  </tr>
</table>
</dd>

</body>


<!-- Mirrored from plasserre.developpez.com/v4-17.htm by HTTrack Website Copier/3.x [XR&CO'2008], Thu, 18 Dec 2008 18:24:50 GMT -->
</html>