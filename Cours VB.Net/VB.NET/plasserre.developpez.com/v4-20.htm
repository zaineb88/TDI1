<html>


<!-- Mirrored from plasserre.developpez.com/v4-20.htm by HTTrack Website Copier/3.x [XR&CO'2008], Thu, 18 Dec 2008 18:24:59 GMT -->
<head>
<meta http-equiv="Content-Language" content="fr">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta NAME="MS.LOCALE" CONTENT="fr-FR">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>Cours Visual Basic .Net  répertoire de données répertoire de l'exécutable Vista</title>
<style>
<!--
h6
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	font-size:11.0pt;
	font-family:"Times New Roman";
	font-weight:bold}
h4
	{margin-right:0cm;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"Times New Roman";
	font-weight:bold}
-->
</style>
</head>

<body background="vfond.jpg" leftmargin="90">

<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="103%" id="AutoNumber1" height="62">
  <tr>
    <td width="27%" height="62"><font face="Courier New" size="2"><b>
    <font color="#0000FF">Site</font></b><img border="0" src="ldf.GIF" width="121" height="51"><font color="#0000FF" size="2">:</font></font></td>
    <td width="56%" height="62" align="center"><b>
    <font color="#0000FF">
    <font face="Courier New" size="2">
    &nbsp;</font></font><font color="#0000FF" face="Courier New" size="7">Cours 
    VB.net</font></b></td>
    <td width="10%" height="62">
    <font face="Courier New" size="2">
    <img border="0" src="vhom.JPG" width="118" height="114"></font></td>
    <td width="34%" height="62"><font face="Courier New" size="2">&nbsp;</font></td>
  </tr>
</table>
<table border="2" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2" height="79">
  <tr>
    <td width="29%" height="79" align="center">
    <font face="Courier New" size="2"><a href="v4-19.htm">
    <img border="0" src="vbtret.GIF" width="78" height="28"></a>  <b>
    <font face="Courier New" size="6" color="#800080">4.20</font></b></font></td>
    <td width="52%" height="79" align="center"><b><font face="Courier New" color="#800080" size="6">Ou
      mettre les programmes, les données?</font></b></td>
    <td width="9%" height="79">
    <font face="Courier New" size="2">
    <a href="v4-21.htm">
    <img border="0" src="vbtsuiv.GIF" width="78" height="28"></a></font></td>
    <td width="11%" height="79"><p>
    <a href="vsommair.htm">
    <font face="Courier New" size="2">
    <img border="0" src="vbtsomm.gif" width="78" height="28"></font></a></p>
    </td>
  </tr>
</table>
<p align="center"><font face="Courier New" size="2"><img border="0" src="vwindow.JPG" width="99" height="79"></font></p>
<p align="left">&nbsp;</p>
<p class="MsoNormal"><b><span style="background-color: #C0C0C0"><font face="Courier New" color="#0000FF" size="4">Il faut séparer les données des programmes
!!!</font></span></b></p>
<p class="MsoNormal"><font size="2" face="Courier New">Les programmes, les
données n’ont pas la même vocation.</font></p>
<p class="MsoNormal"><font size="2" face="Courier New"><b>Les fichiers programmes
</b>( les fichiers .exe)sont copiés sur
votre disque au moment de l’installation du logiciel ou au moment de sa mise
à jour. En dehors de ces périodes, ces fichiers ne changent pas.</font></p>
<p class="MsoNormal"><font size="2" face="Courier New">Il n’est donc pas utile de
sauvegarder fréquemment, car en plus, vous possédez ceux-ci par
ailleurs sur un support d’installation (CD-ROM, fichier téléchargé).</font></p>
<p class="MsoNormal"><font size="2" face="Courier New">Par contre <b> les fichiers
de données</b> sont régulièrement créés, enregistrés&nbsp;ou modifiés: mails, documents Word ou Excel,
photos, fichiers musicaux, bases de données. Pour ne pas perdre toutes ces
informations, il faut les sauvegarder: les enregistrer régulièrement sur un
autre support (CD-ROM, disque dur externe, clé USB, autre ordinateur d'un
réseau..)</font></p>
<p class="MsoNormal"><font size="2" face="Courier New">Pour favoriser vos sauvegardes,
<b><font color="#FF0000"> il est donc
logique de séparer vos données de vos programmes, et de les mettre dans des
répertoires différents.</font></b></font></p>
<p class="MsoNormal"><font face="Courier New" size="2">Habituellement on a un
répertoire de programmes et un répertoire de données, il est possible d'avoir
un répertoire de données pour chaque utilisateur si les données sont
distinctes et parfois un répertoire commun à tous les utilisateurs (AllUsers)</font></p>
<p class="MsoNormal"><font face="Courier New" size="2">Ainsi on peut simplement
sauvegarder régulièrement la totalité du répertoire de données et
uniquement ce répertoire.</font></p>
<p class="MsoNormal"><font size="2" face="Courier New">De même pour éviter les soucis lors de la
réinstallation de Windows, il est plus facile de protéger les données si
celles-ci se trouvent sur un disque ou une partition séparée.</font></p>
<p align="left">&nbsp;</p>
<p align="left"><span style="background-color: #C0C0C0"><b><font face="Courier New" color="#0000FF" size="4">Sécurité:</font></b></span></p>
<p align="left"><font size="2" face="Courier New">Un virus,
un ver ou un spyware est un programme qui va essayer d'utiliser votre accès à Windows
(vos droits d'utilisateur) pour s' &quot;auto-installer&quot; et prendre la main
de votre système.</font>
</p>
<p align="justify"><font size="2" face="Courier New">Or par défaut sous Windows XP vous avez tous
les droits (car vous avez un compte administrateur) : mettre à jour le système, installer des programmes, ce qui n'est
pas vraiment indispensable pour lire vos mails, faire du traitement de texte ou
surfer sur Internet.</font>
<p><font size="2" face="Courier New">Vous pouvez donc utiliser votre Windows de la manière
suivante :</font></p>
<p><font size="2" face="Courier New">- créer des comptes utilisateurs limités pour l'usage
quotidien.</font></p>
<p><font size="2" face="Courier New">- utiliser un compte administrateur pour toutes les
installations et mises à jour.</font></p>
<p><font size="2" face="Courier New">C'est une contrainte mais cela garantit le maximum de
sécurité.</font></p>
<p align="left">&nbsp;</p>
<p align="left"><font face="Courier New" size="2"><font color="#800080"><br>
</font></font><span style="background-color: #C0C0C0"><b><font color="#0000FF" face="Courier New" size="4">Quels
répertoires utiliser ?</font></b></span></p>
<p align="left">&nbsp;</p>
<ul>
  <li>
    <p align="left"><b><span style="background-color: #C0C0C0"><font face="Courier New" size="3">Windows 98:</font></span></b></li>
</ul>
<table border="0" width="100%">
  <tr>
    <td width="26%"><img border="0" src="vrep3.jpg" width="204" height="337"></td>
    <td width="74%">
<p align="left"><font face="Courier New" size="2">Un répertoire '<b>Programs
Files</b>' contient des sous répertoires
pour chaque programme contenant les exécutables.</font></p>
<p align="left"><font face="Courier New" size="2">Un répertoire '<b>Mes
documents</b>' contenant des sous répertoires
pour chaque programme contenant les fichiers de données.</font></p>
<p align="left"><font face="Courier New" size="2">Les paramètres de
l'application sont dans un fichier&nbsp; .ini qui se trouve dans le répertoire
Windows ou le répertoire de l'application ou la base de registre.</font></p>
      <p>&nbsp;</td>
  </tr>
</table>
    <p align="left">&nbsp;
    <p align="left">&nbsp;
<ul>
  <li>
    <p align="left"><b><span style="background-color: #C0C0C0"><font face="Courier New" size="3">Windows
    XP:</font></span></b></li>
</ul>
<table border="0" width="100%">
  <tr>
    <td width="26%"><img border="0" src="vrep1.JPG" width="250" height="604"></td>
    <td width="74%"><font face="Courier New" size="2">Un répertoire 'Programs Files'
      contient des sous répertoires
pour chaque programme contenant les exécutables.</font>
      <p><font face="Courier New" size="2">Un répertoire '<b>Documents ans
      Settings</b>' contient des sous
répertoires pour chaque utilisateur (ici le mien se nomme 'Phil') et un répertoire
      commun à tous les utilisateurs: AllUsers.</font>
      </p>
<p align="left"><font face="Courier New" size="2">Dans chaque répertoire
utilisateur il y a&nbsp;</font></p>
<p align="left"><font face="Courier New" size="2">
un répertoire '<b>Application Data</b>'&nbsp; pour chaque programme contenant les fichiers de données.</font></p>
<p align="left"><font face="Courier New" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
C:\Documents and Settings\phil\Application
Data\OpenOffice.org2\user\database</font></p>
<p align="left"><font face="Courier New" size="2">un répertoire '<b>Mes
documents</b>'</font></p>
<p align="left"><font face="Courier New" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
C:\Documents and Settings\phil\Mes documents\Visual Studio
2005\Projects\chiffreromain</font></p>
<p align="left"><font face="Courier New" size="2">Mais aussi un répertoire '<b>Local
Settings</b>' pour les fichiers de configuration et les exécutables.</font></p>
<p align="left"><font face="Courier New" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
C:\Documents and Settings\phil\Local
Settings\Application Data\Pentax\Digital Camera Utility</font></p>
      <p>&nbsp;</td>
  </tr>
</table>
<p align="left">&nbsp;&nbsp;&nbsp;</p>
<ul>
  <li>
    <p align="left"><b><font face="Courier New" size="3"><span style="background-color: #C0C0C0">Windows
    Vista:</span></font></b></li>
</ul>
<table border="0" width="100%">
  <tr>
    <td width="26%"><img border="0" src="vrep2.JPG" width="202" height="366"></td>
    <td width="74%"><b><font face="Courier New">Version anglaise:</font></b>
      <p><font face="Courier New" size="2">Dans le Desktop,(information trouvée
      sur le Net)</font></p>
      <p>Il y a:</p>
      <p><font face="Courier New" size="2">Un répertoire '<b>Programs Files</b>'</font></p>
      <p><font face="Courier New" size="2">Un répertoire '<b>Users</b>' qui
      contient des répertoires au nom de chaque utilisateurs ('pch' ici par
      exemple)</font></p>
      <p><font face="Courier New" size="2">Dans chaque répertoire utilisateur
      il y a un répertoire <b>AppData</b> pour les données (qui remplace
      Application Data). Dessous , il y a un répertoire <b>Local </b>et encore
      dessous un répertoire au nom de la société qui a fait le logiciel (ici
      Microsoft) puis un répertoire pour le programme et pour la version.&nbsp;</font></p>
      <p><font face="Courier New" size="2">Ainsi les données du programme LDF
      version 1.1.0 crées par PolySoft seront dans le répertoire:</font></p>
      <p><font face="Courier New" size="2">&nbsp;&nbsp; C:\Users\MyName\AppData\Local\PolySoft\LDF\1.1.0\</font></p>
      <p>&nbsp;</td>
  </tr>
</table>
<table border="0" width="100%">
  <tr>
    <td width="26%"><img border="0" src="vvista2.jpg" width="239" height="478"></td>
    <td width="74%"><b><font face="Courier New">Version française:</font></b>
      <p><font face="Courier New" size="2">Dans le Bureau (chez moi)</font></p>
      <p>Il y a:</p>
      <p><font face="Courier New" size="2">Un répertoire au nom de chaque utilisateurs
      ('guillaume' ici par
      exemple)pour les données.</font></p>
      <p><font face="Courier New" size="2">Un répertoire 'Ordinateur'</font></p>
      <blockquote>
      <p><font face="Courier New" size="2">Un sous répertoire 'Disque local(C:)</font>
        <blockquote>
      <p><font face="Courier New" size="2">Un sous répertoire 'Programmes'</font><p><font face="Courier New" size="2">Un
          sous répertoire MonProgralle ou se trouvent le programme exe.</font>
        </blockquote>
      </blockquote>
      <p><font face="Courier New" size="2">Ainsi l'exécutable du programme LDF
      est dans le répertoire:</font></p>
      <p><font face="Courier New" size="2">&nbsp;&nbsp; C:\Programmes\LDF</font></p>
      <p>&nbsp;
      <p>&nbsp;</td>
  </tr>
  <tr>
    <td width="26%"></td>
    <td width="74%"></td>
  </tr>
</table>
<p align="left">&nbsp;</p>
<p align="left"><font color="#FF0000" size="2" face="Courier New">Il 'faudrait' utiliser
ces répertoires pour les exécutables et les données!!!</font></p>
<p align="left"><font face="Courier New" size="2">Quand, par exemple, on
installe un logiciel avec Click once de VB2005 sur un ordinateur Windows XP,
l'exécutable s'installe dans <b>C:\Documents and Settings\Nom Utilisateur\Local
Settings\Apps</b>:</font></p>
<p align="left"><font size="2" face="Courier New" color="#0000FF">C:\Documents and
Settings\phil\Local Settings\Apps\2.0\WD2P2BPB.7A5\OVEEZQLA.BC1\chif..tion_6625898959f0f00b_0001.0000_56fb0b87e9540260</font></p>
<p align="left"><font face="Courier New" size="2">Le fichier de configuration
user.config et les données dans </font><font face="Courier New" size="2"><b>C:\Documents and
Settings\Nom Utilisateur\Application Data</b></font></p>
<p align="left"><font face="Courier New" size="2" color="#0000FF">C:\Documents and Settings\phil\Application
Data\Polytel\WindowsApplication1.vshos_Url_dhzke3q02e3bxuhunbsnp0jhjwtnzb1i\1.0.0.0</font></p>
<p align="left"><font face="Courier New" size="2">(On remarque que après
'..Application Data' le chemin comporte <a name="remarksToggle">\</a><a onclick="javascript:Track('ctl00_LibFrame_ctl09|ctl00_LibFrame_ctl10',this);" href="http://msdn2.microsoft.com/fr-fr/library/system.windows.forms.application.companyname(VS.80).aspx">CompanyName</a>\<a onclick="javascript:Track('ctl00_LibFrame_ctl09|ctl00_LibFrame_ctl11',this);" href="http://msdn2.microsoft.com/fr-fr/library/system.windows.forms.application.productname(VS.80).aspx">ProductName</a><font color="#0000FF">\ProductVersion</font>)</font></p>
<p align="left">&nbsp;</p>
<p align="left"><font color="#FF0000" size="2" face="Courier New">Il ne 'faudrait'
pas utiliser le répertoire 'Program Files\Mon Application' pour les données!!&nbsp;</font></p>
<p align="left"><font face="Courier New" size="2">En fait, beaucoup de programmes écrivent des données directement dans le
répertoire courant de l'application (dans C;\Program Files\MonApplication);
comment cela se passe?</font></p>
<ul>
  <li>
    <p align="left"><font face="Courier New" size="2">Aucun problème avec <b>Windows
    98</b>.&nbsp;</font></li>
</ul>
<p align="left">&nbsp;</p>
<ul>
  <li>
    <p align="left"><font face="Courier New" size="2">Avec
    <b> Windows XP</b>
puisque les comptes limités (comptes utilisateurs standards) n'ont pas accès en écriture au dossier
    %Program
Files% et n'ont pas accès à HKEY-Local_Machine du registre; le problème à
    été résolu simplement: De manière générale les utilisateurs ont un
    compte administrateur, donc, ils ont tous les droits et peuvent écrire
    leurs données dans Program Files et modifier le registre!!</font></li>
</ul>
<p align="left">&nbsp;</p>
<ul>
  <li>
    <p align="left"><font face="Courier New" size="2"><b>
Vista</b> &quot;contourne ce problème&quot;: si on installe un programme qui
    veut utiliser le répertoire 'Program Files', Vista utilise un répertoire <b>VirtualStore</b>
    dans lequel il place un faux répertoire 'Program Files', en effet tous les programmes qui tentent
d'écrire vers %Program Files% ou %windir% seront automatiquement redirigés vers&nbsp;
    'C:\Users\Nom Utilisateur\AppData\Local\VirtualStore\Program Files'. Si le
programme tente ensuite de lire le fichier précédemment écrit, le programme lira automatiquement le bon fichier. Tout ceci
est invisible pour le programme, c'est Vista qui gère tout( le répertoire AppData\Local\VirtualStore
    serait caché). On appelle cela la 'virtualisation'. Attention donc, si le
    programme veut écrire dans&nbsp;</font> <i>C:\Program Files\MonProg\utilisateur</i>
    , en fait, il écrira dans <i>C:\Users\<b>nom d'utilisateur</b>\AppData\Local\VirtualStore\Program
    Files\MonProg\utilisateur.</i> .&nbsp;<font face="Courier New" size="2">&nbsp;</font></li>
</ul>
<p align="left">&nbsp;</p>
<p><b><font color="#0000FF" face="Courier New" size="4"><span style="background-color: #C0C0C0">Obtenir
le répertoire de l'exécutable et des données:</span></font></b></p>
<p><font face="Courier New" size="2">Rien de plus simple (dans un programme VB
2005 sous Windows XP), pour un utilisateur:</font></p>
<p><font color="#0000FF" size="2" face="Courier New">Application.StartupPath </font><font size="2" face="Courier New">donne
le répertoire de l'exécutable.</font></p>
<p><font size="2" face="Courier New">Exemple: dans l'environnement de développement
VB 2005, pour le programme WindowsApplication2:</font></p>
<p><font face="Courier New" size="2">C:\Documents and Settings\phil\Mes documents\Visual Studio
2005\Projects\WindowsApplication2\WindowsApplication2\bin\Debug</font></p>
<p><font color="#0000FF" size="2" face="Courier New">Application.UserAppDataPath
</font><font size="2" face="Courier New">donne le répertoire de données.</font></p>
<p><font face="Courier New" size="2">&nbsp;C:\Documents and Settings\phil\Application Data\WindowsApplication1\WindowsApplication1\1.0.0.0</font></p>
<p><font face="Courier New" size="2">De même on peut obtenir </font><font face="Courier New" size="2"> la clé de Registre des données d'application.</font>
</p>
<p><font face="Courier New" size="2" color="#0000FF">Application.UserAppDatRegistry</font>
</p>
<p>&nbsp;</p>
<p><font face="Courier New" size="2">Pour les données et le registre commun à
tous les utilisateurs:</font></p>
<p><font color="#0000FF" size="2" face="Courier New">Application.CommonAppDataPath&nbsp;</font></p>
<p><font face="Courier New" size="2" color="#0000FF">Application.CommonAppDatRegistry</font></p>
<p>&nbsp;</p>
<p></p>
<p><b><font color="#0000FF" face="Courier New" size="4"><span style="background-color: #C0C0C0">Droits
d'accès des utilisateurs dans Vista : l'UAC.</span></font></b></p>
<p><font face="Courier New" size="2">Pour réduire les effets des logiciels malveillants, Windows Vista inclut un
nouveau modèle de sécurité dénommé <strong>User Account Control</strong> (UAC)
qui marque un tournant comparé au modèle traditionnel des privilèges accordés
aux utilisateurs de Windows, et affecte presque tous les utilisateurs Windows.
L'UAC vise à améliorer l'expérience des utilisateurs standards de Windows,
tout en réduisant le risque constitué par les logiciels malveillants.</font></p>
<p><font face="Courier New" size="2">Dans l'UAC, tous les utilisateurs Windows Vista, dont ceux qui possèdent des
droits d'administrateur, interagissent avec leurs PC en tant qu'utilisateurs
standards la plupart du temps. Le compte utilisateur standard Windows continue
de ne pas avoir de privilèges d'administrateur, ce qui évite à un logiciel
malveillant téléchargé malencontreusement par un tel compte de s'installer
sur l'ordinateur. Ainsi, le logiciel malveillant qui s'infiltre d'une façon ou
d'une autre dans un PC ne peut accéder ni à la base des registres ni aux répertoires
protégés.</font></p>
<p><font face="Courier New" size="2">Si vous essayez d'effectuer une tâche qui nécessite des privilèges
d'administrateur, comme l'installation d'un logiciel ou le changement d'état du
pare-feu Windows, Windows Vista vous invite explicitement à donner votre
autorisation et à vous identifier avant de vous faire passer temporairement au
rang d'administrateur pour achever la tâche en cours. Pour un utilisateur
standard, cela signifie concrètement la saisie d'un <strong>nom d'utilisateur</strong>
et d'un <strong>mot de passe</strong> qui appartiennent à un membre du groupe
Administrateurs</font></p>
<p><font face="Courier New" size="2">Dans Windows Vista avec le modèle UAC, les comptes utilisateurs standards
ont été modifiés pour offrir des privilèges supplémentaires:</font></p>
<ul type="disc">
  <li><font face="Courier New" size="2">visualiser les horloges systèmes et les calendriers</font>
  <li><font face="Courier New" size="2">modifier les fuseaux horaires</font>
  <li><font face="Courier New" size="2">changer les paramètres de gestion de la puissance</font>
  <li><font face="Courier New" size="2">ajouter des imprimantes si les bons drivers sont installés sur
    l'ordinateur</font>
  <li><font face="Courier New" size="2">créer et configurer des connexions VPN</font>
  <li><font face="Courier New" size="2">installer les mises à jour Windows essentielles</font></li>
</ul>
<p><font face="Courier New" size="2">Dans les versions précédentes de Windows, un non-administrateur ne pouvait
pas facilement comprendre quelles actions lui étaient autorisées. Dorénavant,
Windows Vista utilise une <strong>icône de protection</strong> pour vous aider
à comprendre quelles tâches seuls les administrateurs ont le droit d'effectuer</font></p>
<dl>
<dd>
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber3" height="51">
  <tr>
    <td width="25%" height="51">
    <font face="Courier New" size="2">
    <a href="v4-19.htm">
    <img border="0" src="vbtret.GIF" width="78" height="28"></a></font></td>
    <td width="25%" height="51"><a href="vindex.htm">
    <font face="Courier New" size="2">
    <img src="vbtind.GIF" border="0" width="78" height="28"></font></a></td>
    <td width="25%" height="51">
    <a href="vsommair.htm">
    <font face="Courier New" size="2">
    <img border="0" src="vbtsomm.gif" width="78" height="28"></font></a></td>
    <td width="25%" height="51">
    <font face="Courier New" size="2">
    <a href="v4-21.htm">
    <img border="0" src="vbtsuiv.GIF" width="78" height="28"></a></font></td>
  </tr>
</table>
</dd>

</body>


<!-- Mirrored from plasserre.developpez.com/v4-20.htm by HTTrack Website Copier/3.x [XR&CO'2008], Thu, 18 Dec 2008 18:25:04 GMT -->
</html>